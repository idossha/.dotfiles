#!/bin/bash
# mnt-home: Mount homelab SSD over WireGuard

MOUNTPOINT="$HOME/homelab"
REMOTE="idohaber@10.200.200.1:/srv/storage"

# Check if already mounted
if mount | grep -q "$MOUNTPOINT"; then
    echo "‚úÖ $MOUNTPOINT is already mounted."
    exit 0
fi

# Mount via SSHFS
echo "üîó Mounting $MOUNTPOINT..."
sshfs -o uid=$(id -u),gid=$(id -g),reconnect,ServerAliveInterval=15,ServerAliveCountMax=3 \
      "$REMOTE" "$MOUNTPOINT"

if [ $? -eq 0 ]; then
    echo "‚úÖ Mounted successfully!"
    df -h "$MOUNTPOINT"
else
    echo "‚ùå Mount failed! Is WireGuard active?"
fi


